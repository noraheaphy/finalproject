"0","n_tips = length(portulacaTree$tip.label)
# root tree manually based on Ocampo & Columbus
portulacaTree <- root(portulacaTree, node = 28, edgelabel = TRUE)
is.rooted(portulacaTree)
"
"1","[1]"
"1"," TRUE"
"1","
"
"0","# get the root node by finding the node that is a parent (in column 1 of edge) "
"0","# but not a child (in column 2 of edge)"
"0","# root_node = portulacaTree$edge[(!portulacaTree$edge[,1] %in% portulacaTree$edge[,2]),1] %>%"
"0","#  unique()"
"0","root_node = 28 # temporarily assigning manually because I can't get it to work the other way"
"0","# get the maximum distance from the root to another node, which will be for a tip."
"0","# since this tree happens to be ultrametric, this will be the root age"
"0","root_age = max(dist.nodes(portulacaTree)[, root_node])"
"0","# this isn't necessary, but since we don't know the units of edge length let's rescale"
"0","# the tree so that the age of the root is 1."
"0","# this could be a place to add noise into edge lengths to see how robust the analysis is"
"0","portulacaTree$edge.length = portulacaTree$edge.length/root_age"
"0","    "
"0","# and now recalculate the root age to make sure things look good"
"0","root_age = max(dist.nodes(portulacaTree)[, root_node])"
